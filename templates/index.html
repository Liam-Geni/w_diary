<!doctype html>
<html lang="en">
<head>

    <!-- Webpage Title -->
    <title>Home | W_Dairy</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <!-- Font Awesome CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Gothic+A1:wght@400;600&family=Nanum+Gothic&family=Nanum+Pen+Script&display=swap"
          rel="stylesheet">

    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>


    <script>
        function sign_out() {
            $.removeCookie('mytoken,{' / '}')
            alert('로그아웃')
            window.location.href = "/login"
        }

        $(document).ready(function () {
            get_regionlist()
            get_posts()
        })

        function get_regionlist() {
            $.ajax({
                type: "GET",
                url: "http://openapi.seoul.go.kr:8088/6d4d776b466c656533356a4b4b5872/json/RealtimeCityAir/1/99",
                data: {},
                success: function (response) {
                    let rows = response["RealtimeCityAir"]["row"];
                    $("gu-list").empty()
                    for (let i = 0; i < rows.length; i++) {
                        let gu_name = rows[i]["MSRSTE_NM"]
                        let html_temp = `<a class="navbar-item" onclick="get_posts(${gu_name}) style="color:#87CEFA; ">${gu_name}</a>`

                        $("#gu-list").append(html_temp)
                    }
                }
            })
        }

        function get_posts(gu_name) {
            if (gu_name == undefined) {
                gu_name = ""
            }
            $("#cards").empty()
            $.ajax({
                type: "GET",
                url: "/get_posts?gu_name_give=${gu_name}",
                data: {},
                success: function (response) {
                    if (response["result"] == "success") {
                        let posts = response["posts"]
                        for (let i = 0; i < posts.length; i++) {
                            let post = posts[i]
                            let time_post = new Date(post["date"])
                            let time_before = time2str(time_post)
                            let html_temp = `<div class="card">
                                                <div class="card-image">
                                                    <figure class="image is-4by3">
                                                        <img src="/static/${post['profile_pic_real']} alt="Profile Image">
                                                    </figure>
                                                </div>
                                                <div class="card-content">
                                                    <div class="media">
                                                        <div class="media-left">
                                                            <figure class="image is-48x48">
                                                                <img src="/static/${post['img']} alt="Image">
                                                            </figure>
                                                        </div>
                                                        <div class="media-content">
                                                            <p class="title is-5"> ${post['weather']} ${post['region']}</p>
                                                            <p class="subtitle is-6">${post['id']}</p>
                                                        </div>
                                                    </div>

                                                    <div class="content">
                                                        ${post['text']}
                                                        <p style="font-size: smaller; margin-top:1em">${time_before}</p>
                                                    </div>
                                                </div>
                                            </div>`

                            $("cards").append(html_temp)
                        }
                    }
                }
            })
        }
    </script>

</head>
<body>
<nav class="navbar is-fixed-top is-white logo" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <strong class="is-sparta"
                    style="font-family: 'Gamja Flower', cursive; font-size: xx-large;">날씨일기</strong>
        </a>
    </div>
</nav>


<nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-menu is-active">
        <div class="navbar-end">
            <a class="navbar-item" onclick="sign_out()" style="color:#87CEFA;">로그아웃</a>
            <a class="navbar-item" href="/" style="color:#87CEFA;">마이페이지</a>
            <a class="navbar-item" href="/" style="color:#87CEFA;">일기 쓰기</a>
            <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" style="color:#87CEFA;">
                    지역 검색
                </a>
                <div class="navbar-dropdown" id="gu-list">
                </div>
            </div>
        </div>
    </div>
</nav>

<section class="section main">
    <div class="container" id="cards">
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-left">
                        <figure class="image is-48x48">
                            <img src="https://bulma.io/images/placeholders/96x96.png" alt="Placeholder image">
                        </figure>
                    </div>
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    나가서 놀기 딱 좋은 날씨
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>
                <div class="content">
                    나가서 놀기 딱 좋은 날씨 우아아아ㅏ아아아아아아아아아ㅏ아아아아
                    집갈래래래래래ㅐ래랠래래래ㅐ래래래래래ㅐ래래래래래래래ㅐ래래ㅐ래
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    CSS 이 정도만 하면 안 될까요?ㅠㅠㅠㅠㅠㅠ
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    아아라라라라라라라라아아라라라라라라라라아아라라라라라라라라아아라라라라라라라라아아라라라라라라라아아라라라라라라라라아아라라라라라라라라아아라라라라라라라라아아라라라라라아아라라라라라라라라
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    CSS 이 정도만 하면 안 될까요?ㅠㅠㅠㅠㅠㅠ
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    가나다라마바사아자차카타파하
                    총 96자로 제한하시죠!!!
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                </figure>
            </div>
            <div class="card-content">
                <div class="media">
                    <div class="media-content">
                        <p class="title is-5"> ☁ 종로구</p>
                        <p class="subtitle is-6">아이디</p>
                    </div>
                </div>

                <div class="content">
                    CSS 이 정도만 하면 안 될까요?ㅠㅠㅠㅠㅠㅠ
                    <p style="font-size: smaller; margin-top:1em">몇 분 전</p>
                </div>
            </div>
        </div>
    </div>
</section>

</body>
</html>
